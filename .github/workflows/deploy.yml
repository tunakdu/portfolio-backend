name: Deploy to Production

on:
  push:
    branches: [ master ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Deploy to server
      uses: appleboy/ssh-action@v1.0.3
      with:
        host: ${{ secrets.VPS_HOST }}
        username: ${{ secrets.VPS_USERNAME }}
        password: ${{ secrets.VPS_PASSWORD }}
        port: ${{ secrets.VPS_PORT || 22 }}
        timeout: 300s
        script: |
          echo "ðŸš€ GitHub Actions deployment baÅŸlatÄ±lÄ±yor..."
          cd /home/tunakdu/web/akduhan.com/public_html
          
          # TÃ¼m local deÄŸiÅŸiklikleri temizle ve en son versiyonu al
          git reset --hard HEAD
          git clean -fd
          git pull origin master
          
          # Deploy script'i Ã§alÄ±ÅŸtÄ±rÄ±labilir yap
          chmod +x deploy.sh
          
          # Deploy script'i Ã§alÄ±ÅŸtÄ±r
          ./deploy.sh
          
          echo "âœ… GitHub Actions deployment tamamlandÄ±!"